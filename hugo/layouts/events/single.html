{{ define "main" }}
<section id="main">
  <h2 id="title">
    {{ .Title }}
  </h2>
  <hr />

  {{ $venue := index .Site.Data.venues .Params.venue }}
  {{ $volumes := index $venue "volumes_by_year" .Params.year }}
  <div class="card bg-light mb-2 mb-lg-4">
    <div class="card-body">
      <h4 class="card-title">Contents</h4>
      <ul class="list-pl-responsive">
        {{ range $volumes }}
        {{ $volume := index $.Site.Data.volumes . }}
        <li>
          <span class="text-muted align-middle">[{{ . }}]:&nbsp;</span>
          <a class="align-middle" href="#{{ . | anchorize }}">{{ $volume.title }}</a>
          <span class="badge badge-info align-middle ml-1">{{ len $volume.papers }}&nbsp;papers</span>
        </li>
        {{ end }}
      </ul>
    </div>
  </div>

  {{ range $volumes }}
  {{ $volume_id := slicestr . 0 3 }}
  {{ $volume := index $.Site.Data.volumes . }}
  <div id="{{ . | anchorize }}">
    <small><a href="#" class="text-muted"><i class="fas fa-arrow-up"></i> up</a></small>
    <h4 class="pb-2">
      <span class="mr-2">
      <a class="badge badge-primary align-middle" href="{{ $volume.url }}" title="Open full PDF of '{{ $volume.title | htmlEscape }}'">pdf (full)</a>
      <!-- TODO: bib export link -->
      <a class="badge badge-secondary align-middle" href="#" title="Export '{{ $volume.title | htmlEscape }}' to bib format">bib</a>
      <a class="badge badge-secondary align-middle" href="https://www.google.com/search?{{ (querify "q" $volume.title) | safeURL }}" title="Search for '{{ $volume.title | htmlEscape }}' on Google">
        <i class="fas fa-search"></i>
      </a>
      </span>
    <a class="align-middle" href="{{ relref $ (printf "/volumes/%s.md" .) }}">{{ $volume.title }}</a></h4>

    {{ range $volume.papers }}
      {{ $entry := index (index $.Site.Data.papers $volume_id) . }}
      {{ partial "paper-list-entry.html" (dict "context" $ "paper_id" .) }}
    {{ end }}
  </div>
  <hr />
  {{ end }}
</section>
{{ end }}
