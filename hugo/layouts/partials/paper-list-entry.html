{{ $paper := index (index .context.Site.Data.papers (slicestr .paper_id 0 3)) .paper_id }}
{{ $paper_link := printf "/papers/%s/%s/%s.md" (slicestr .paper_id 0 1) (slicestr .paper_id 0 3) .paper_id }}
<p>
  <span class="mr-2">
  {{ with $paper.revision }}
    {{ range last 1 . }}
    <a class="badge badge-primary align-middle" href="{{ .url }}" title="Open latest revision PDF of '{{ $paper.title | htmlEscape }}'">
      pdf&nbsp;(v{{ .id }})
    </a>
    {{ end }}
  {{ end }}
    <a class="badge badge-{{ cond (isset $paper "revision") "secondary" "primary" }} align-middle" href="{{ $paper.url }}" title="Open PDF of '{{ $paper.title | htmlEscape }}'">
      pdf{{ with $paper.revision }}&nbsp;(v1){{ end }}
    </a>
    <!-- TODO: bib export link -->
    <a class="badge badge-secondary align-middle" href="#" title="Export '{{ $paper.title | htmlEscape }}' to bib format">
      bib
    </a>
    <a class="badge badge-secondary align-middle" href="https://www.google.com/search?{{ (querify "q" $paper.title) | safeURL }}" title="Search for '{{ $paper.title | htmlEscape }}' on Google">
      <i class="fas fa-search"></i>
    </a>
    <!-- TODO: attachment links -->
  </span>
    <strong><a class="align-middle" href="{{ relref .context $paper_link }}">{{ $paper.title }}</a></strong>
    <br />
    <span class="text-muted">[{{ .paper_id }}]:</span>
    {{ with $paper.author }}
      {{ $len := (len $paper.author) }}
      {{ range $index, $person := $paper.author }}
        <!-- TODO: link to author page -->
        {{ $first_letter := slicestr $person 0 1 }}
        <a href="#">{{ (index $.context.Site.Data.people $first_letter $person).full }}</a>
        {{ if ne (add $index 1) $len }} | {{ end }}
      {{ end }}
    {{ end }}
</p>
